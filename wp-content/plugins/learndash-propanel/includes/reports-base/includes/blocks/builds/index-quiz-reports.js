(()=>{"use strict";var e={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},d:(t,r)=>{for(var o in r)e.o(r,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:r[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.i18n,r=window.React;var o=e.n(r);class s extends o().Component{constructor(e){super(e)}render(){let e="",o="";return 1==this.props.text&&(o=(0,r.createElement)("span",{className:"supporting-text"},(0,t.__)("Your report is being generated.","learndash-reports-pro"))),e=(0,r.createElement)("div",{className:"wisdm-learndash-reports-chart-block"},(0,r.createElement)("div",{className:"wisdm-learndash-reports-revenue-from-courses graph-card-container"},(0,r.createElement)("div",{className:"wisdm-graph-loading"},(0,r.createElement)("img",{src:wisdm_learndash_reports_front_end_script_total_revenue_earned.plugin_asset_url+"/images/loader.svg"}),o))),e}}const a=s,n=window.wp.element;function i(e,t,r,o,s){change_entry_count(e,t),change_page_number(e,r,o,s)}function l(e,t){let r;if(void 0===t)return;if(t.hasOwnProperty("length"))return;let o=null,s="",a=null,n="";const i=t.limit*(t.page-1);for(let e=0;e<t.data.length;e++)jQuery(window).width()<1500&&(o=jQuery(t.data[e].quiz_title),s=o.text().substring(0,30),o.text().length>30&&(s+="..."),o.text(s),t.data[e].quiz_title=o.outerHTML(),a=jQuery(t.data[e].user_name),n=a.text().substring(0,30),a.text().length>30&&(n+="..."),a.text(n),t.data[e].user_name=a.outerHTML()),t.data[e].index=i+(e+1);r=jQuery(e).DataTable({paging:!1,ordering:!1,searching:!1,info:!1,responsive:!1,data:t.data,columns:[{data:"index"},{data:"quiz_title"},{data:"user_name"},{data:"date_attempt"},{data:"score"},{data:"time_taken"},{data:"link"}],columnDefs:[{targets:[0,3,4,5,6],className:"dt-center"},{targets:[1,2],className:"dt-left"}],language:{emptyTable:t.no_data}})}function d(e,t,r=qre_export_obj.first_custom_url){const o={},s=document.createElement("a");s.href=r;const a=s.search.split(/\?|&/);for(let e=0;e<a.length;e++){if(!a[e])continue;const t=a[e].split("=");o[t[0]]=t[1]}o[e]=t;const n=[];return Object.keys(o).forEach((function(e){n.push(e+"="+o[e])})),s.search="?"+n.join("&"),s.href}function u(e){if(e<1)return!1;jQuery.get(wisdm_learndash_reports_front_end_script_quiz_reports.ajaxurl,{action:"get_quiz_reports_data",nonce:wisdm_learndash_reports_front_end_script_quiz_reports.report_nonce,report:"custom",page:e,pageno:e,wpml_lang:wisdm_ld_reports_common_script_data.wpml_lang},(function(e){jQuery(".wisdm-learndash-reports-quiz-reports").html(e.data.html),l("#qre_summarized_data",e.data.entries),jQuery("div.pagination-section > a").on("click",(function(e){e.preventDefault(),u(function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");const r=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return r?r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):"":null}("paged",jQuery(this).attr("href")))}));const t=document.getElementsByClassName("wrld-loader");t.length>0&&(0,n.createRoot)(t[0]).render(o().createElement(a))}))}document.addEventListener("wisdm-ld-reports-report-type-selected",(function(e){if("quiz-reports"==e.detail.active_reports_tab){if(!wisdm_ld_reports_common_script_data.is_pro_version_active){let e="";wisdm_ld_reports_common_script_data.is_admin_user&&(e='<div><a className="wrld-upgrade-btn" target="__blank" href="https://go.learndash.com/ppaddon">'+(0,t.__)("Upgrade to PRO","learndash-reports-pro")+"</a></div> <span>"+(0,t.__)("OR","learndash-reports-by-wisdmlabs")+"</span>");const r="<img src="+wisdm_ld_reports_common_script_data.plugin_asset_url+"'/images/qrt.png'}></img>",o='<div className="wrld-upgrade-container"><div className="wrld-upgrade-content"><span>'+(0,t.__)("Available in ProPanel","learndash-reports-pro")+"</span>"+e+'<div><a className="wrld-learn-more" target="__blank" href="https://go.learndash.com/ppaddon">'+(0,t.__)("Learn More","learndash-reports-by-wisdmlabs")+"</a></div></div></div>";jQuery(".wisdm-learndash-reports-quiz-reports").html(r),jQuery(".wisdm-learndash-reports-quiz-reports").append(o),jQuery(".wisdm-learndash-reports-quiz-reports").parent().addClass("wrld-dummy-report")}jQuery(".wisdm-learndash-reports-quiz-reports").parent().show();const e=document.getElementsByClassName("wrld-loader");e.length>0&&(0,n.createRoot)(e[0]).render(o().createElement(a))}else jQuery(".wisdm-learndash-reports-quiz-reports").parent().hide()})),document.addEventListener("wisdm-ld-reports-default-quiz-report-filters-applied",(function(e){let t=d("ld_report_type","quiz-reports");t=d("report","quiz",t),t=d("period","year",t),t=d("from_date","",t),t=d("to_date","",t),t=d("qre_search_field",e.detail.selection_label,t),t=d("search_result_id",e.detail.selection_id,t),t=d(e.detail.selection_type,e.detail.selection_id,t);let r="post";"quiz"==e.detail.selection_type?r="post":"user"==e.detail.selection_type&&(r="user");let s=1;const u=jQuery("div.pagination-section > input.page").val();null!=u&&u>0&&(s=u),jQuery(".qre-reports-content, .custom-reports-content, .qre-reports-content").html(""),jQuery(".wrld-loader").show(),jQuery.get(wisdm_learndash_reports_front_end_script_quiz_reports.ajaxurl,{action:"get_quiz_reports_data",nonce:wisdm_learndash_reports_front_end_script_quiz_reports.report_nonce,report:e.detail.report_selector,search_result_type:r,search_result_id:e.detail.selection_id,qre_search_field:e.detail.selection_label,page:s,pageno:s,wpml_lang:wisdm_ld_reports_common_script_data.wpml_lang},(function(e){jQuery(".wisdm-learndash-reports-quiz-reports").html(e.data.html),jQuery(".wrld-loader").hide(),wisdm_learndash_reports_front_end_script_quiz_reports.lastCustomDefaultQuiryParams=null!=e.data.entries.query_params?e.data.entries.query_params:[],l("#qre_summarized_data",e.data.entries),i(".pagination-form","select.limit",".pagination-section input.page",".pagination-section button.previous-page",".pagination-section button.next-page");const t=document.getElementsByClassName("wrld-loader");t.length>0&&(0,n.createRoot)(t[0]).render(o().createElement(a))}))})),document.addEventListener("wisdm-ld-reports-default-custom-quiz-report-filters-applied",(function(e){const t=e.detail.fields_selected;t.course_filter=e.detail.selected_courses,t.group_filter=e.detail.selected_groups,t.quiz_filter=e.detail.selected_quizes,t.start_date=e.detail.start_date,t.end_date=e.detail.end_date,jQuery(".qre-reports-content, .custom-reports-content, .qre-reports-content").html(""),jQuery(".wrld-loader").show(),jQuery.ajax({type:"POST",url:qre_export_obj.ajax_url,timeout:1e5,retry_count:0,retry_limit:1,data:{action:"qre_save_filters",security:qre_export_obj.custom_reports_nonce,fields:t},success(e){jQuery(document).trigger("custom_reports_config_set"),u(1),jQuery("div.pagination-section > a").on("click",(function(e){e.preventDefault(),console.log(e)}));const t=document.getElementsByClassName("wrld-loader");t.length>0&&(0,n.createRoot)(t[0]).render(o().createElement(a))},error(e,t,r){"timeout"===t?(this.retry_count++,this.retry_count<=this.retry_limit?(console.log("Retrying"),jQuery.ajax(this)):(console.error("request timed out"),jQuery(document).trigger("custom_reports_config_set"))):(console.log(r),jQuery(document).trigger("custom_reports_config_set"))}})})),document.addEventListener("wisdm-ld-reports-custom-quiz-report-filters-applied",(function(e){const t=e.detail.fields_selected;t.course_filter=e.detail.selected_courses,t.group_filter=e.detail.selected_groups,t.quiz_filter=e.detail.selected_quizes,t.start_date=e.detail.start_date,t.end_date=e.detail.end_date,jQuery(".qre-reports-content, .custom-reports-content, .qre-reports-content").html(""),jQuery(".wrld-loader").show(),jQuery.ajax({type:"POST",url:qre_export_obj.ajax_url,timeout:1e5,retry_count:0,retry_limit:1,data:{action:"qre_save_filters",security:qre_export_obj.custom_reports_nonce,fields:t},success(e){u(1)},error(e,t,r){"timeout"===t?(this.retry_count++,this.retry_count<=this.retry_limit?(console.log("Retrying"),jQuery.ajax(this)):(console.error("request timed out"),jQuery(document).trigger("custom_reports_config_set"))):(console.log(r),jQuery(document).trigger("custom_reports_config_set"))}}),document.getElementById("wisdm-learndash-reports-quiz-report-view").scrollIntoView()})),document.addEventListener("wrld-fetch-export-data-count",(function(e){const t={};var r;t.course_filter=e.detail.selected_courses,t.group_filter=e.detail.selected_groups,t.quiz_filter=e.detail.selected_quizes,t.start_date=e.detail.start_date,t.end_date=e.detail.end_date,r=t,jQuery.ajax({type:"POST",url:qre_export_obj.ajax_url,timeout:1e5,retry_count:0,retry_limit:1,data:{action:"wrld_export_entries",security:qre_export_obj.custom_reports_nonce,fields:r},success(e){jQuery(".bulk-export-heading div span").text(e.data.count.attempt_count)}})})),document.addEventListener("wrld-bulk-export-attempt-results-success",(function(e){jQuery(".export-attempt-results .bulk-export-progress").addClass("wrld-hidden"),jQuery(".export-attempt-results .bulk-export-progress progress").val(0),jQuery(".export-attempt-results .bulk-export-progress span").text(""),jQuery(".export-attempt-results .bulk-export-download").append('<a className="button btn btn-primary" href="'+e.detail.result.data.link+'" download><span className="dashicons dashicons-download"></span>Download '+e.detail.filetype.toUpperCase()+"</a>"),jQuery(".export-attempt-results .bulk-export-download").removeClass("wrld-hidden")})),document.addEventListener("wrld-bulk-export-learner-results-success",(function(e){jQuery(".export-attempt-learner-answers .bulk-export-progress").addClass("wrld-hidden"),jQuery(".export-attempt-learner-answers .bulk-export-progress progress").val(0),jQuery(".export-attempt-learner-answers .bulk-export-progress span").text(""),jQuery(".export-attempt-learner-answers .bulk-export-download").append('<a className="button btn btn-primary" href="'+e.detail.result.data.link+'" download><span className="dashicons dashicons-download"></span>Download '+e.detail.filetype.toUpperCase()+"</a>"),jQuery(".export-attempt-learner-answers .bulk-export-download").removeClass("wrld-hidden")})),document.addEventListener("wrld-bulk-export-attempt-results",(function(e){jQuery(".export-attempt-results .bulk-export-progress label").text(e.detail.type.toUpperCase()+" export in progress"),jQuery(".export-attempt-results .bulk-export-progress").removeClass("wrld-hidden");let t=0;jQuery(".export-attempt-results .report-export-buttons div span").text();var r=setInterval((function(){jQuery.ajax({type:"POST",url:qre_export_obj.ajax_url,timeout:1e5,retry_count:0,retry_limit:1,data:{action:"wrld_export_progress_results",security:qre_export_obj.custom_reports_nonce},success(e){t=e.data.percentage,t<=100&&(jQuery(".export-attempt-results .bulk-export-progress progress").val(t),jQuery(".export-attempt-results .bulk-export-progress span").text(t+"% Complete")),t>=100&&clearInterval(r)},error(e,t,r){"timeout"===t?(this.retry_count++,this.retry_count<=this.retry_limit?(console.log("Retrying"),jQuery.ajax(this)):console.error("request timed out")):console.log(r)}})}),1e3)})),document.addEventListener("wrld-bulk-export-learner-results",(function(e){jQuery(".export-attempt-learner-answers .bulk-export-progress label").text(e.detail.type.toUpperCase()+" export in progress"),jQuery(".export-attempt-learner-answers .bulk-export-progress").removeClass("wrld-hidden");let t=0;jQuery(".export-attempt-results .report-export-buttons div span").text();var r=setInterval((function(){jQuery.ajax({type:"POST",url:qre_export_obj.ajax_url,timeout:1e5,retry_count:0,retry_limit:1,data:{action:"wrld_export_progress_results",security:qre_export_obj.custom_reports_nonce},success(e){t=e.data.percentage,t<=100&&(jQuery(".export-attempt-learner-answers .bulk-export-progress progress").val(t),jQuery(".export-attempt-learner-answers .bulk-export-progress span").text(t+"% Complete")),t>=100&&clearInterval(r)},error(e,t,r){"timeout"===t?(this.retry_count++,this.retry_count<=this.retry_limit?(console.log("Retrying"),jQuery.ajax(this)):console.error("request timed out")):console.log(r)}})}),1e3)})),document.addEventListener("wrld-bulk-export-attempt-results",(function(e){const t={};t.course_filter=e.detail.selected_courses,t.group_filter=e.detail.selected_groups,t.quiz_filter=e.detail.selected_quizes,t.type=e.detail.type,t.start_date=e.detail.start_date,t.end_date=e.detail.end_date,jQuery(".filter-section").css({opacity:.5,"pointer-events":"none"}),jQuery(".bulk-export-download").css({opacity:.5,"pointer-events":"none"}),jQuery.ajax({type:"POST",url:qre_export_obj.ajax_url,timeout:1e5,retry_count:0,retry_limit:1,data:{action:"wrld_export_attempt_results",security:qre_export_obj.custom_reports_nonce,fields:t},success(t){jQuery(".filter-section").css({opacity:1,"pointer-events":"auto"}),jQuery(".bulk-export-download").css({opacity:1,"pointer-events":"auto"});const r=new CustomEvent("wrld-bulk-export-attempt-results-success",{detail:{result:t,filetype:e.detail.type}});document.dispatchEvent(r)},error(e,t,r){"timeout"===t?(this.retry_count++,this.retry_count<=this.retry_limit?(console.log("Retrying"),jQuery.ajax(this)):console.error("request timed out")):console.log(r)}})})),document.addEventListener("wrld-bulk-export-learner-results",(function(e){const t={};t.course_filter=e.detail.selected_courses,t.group_filter=e.detail.selected_groups,t.quiz_filter=e.detail.selected_quizes,t.type=e.detail.type,t.start_date=e.detail.start_date,t.end_date=e.detail.end_date,jQuery(".filter-section").css({opacity:.5,"pointer-events":"none"}),jQuery(".bulk-export-download").css({opacity:.5,"pointer-events":"none"}),jQuery.ajax({type:"POST",url:qre_export_obj.ajax_url,timeout:1e5,retry_count:0,retry_limit:1,data:{action:"wrld_export_learner_results",security:qre_export_obj.custom_reports_nonce,fields:t},success(t){jQuery(".filter-section").css({opacity:1,"pointer-events":"auto"}),jQuery(".bulk-export-download").css({opacity:1,"pointer-events":"auto"});const r=new CustomEvent("wrld-bulk-export-learner-results-success",{detail:{result:t,filetype:e.detail.type}});document.dispatchEvent(r)},error(e,t,r){"timeout"===t?(this.retry_count++,this.retry_count<=this.retry_limit?(console.log("Retrying"),jQuery.ajax(this)):console.error("request timed out")):console.log(r)}})})),document.addEventListener("wisdm-ld-custom-report-type-select",(function(e){if(jQuery(".qre-reports-content, .custom-reports-content, .qre-reports-content").html(""),jQuery(".wrld-loader").show(),"custom"==e.detail.report_selector)u(1);else{const t=1;jQuery.get(wisdm_learndash_reports_front_end_script_quiz_reports.ajaxurl,{action:"get_quiz_reports_data",nonce:wisdm_learndash_reports_front_end_script_quiz_reports.report_nonce,report:e.detail.report_selector,page:t,pageno:t,wpml_lang:wisdm_ld_reports_common_script_data.wpml_lang},(function(t){jQuery(".wisdm-learndash-reports-quiz-reports").html(t.data.html),l("#qre_summarized_data",t.data.entries),""==e.detail.report_selector&&i(".pagination-form","select.limit",".pagination-section input.page",".pagination-section button.previous-page",".pagination-section button.next-page");const r=document.getElementsByClassName("wrld-loader");r.length>0&&(0,n.createRoot)(r[0]).render(o().createElement(a))}))}})),window.change_entry_count=function(e,t){jQuery(t).on("change",(function(){const e=jQuery(this).find("option:selected").val(),t={action:"get_quiz_reports_data",nonce:wisdm_learndash_reports_front_end_script_quiz_reports.report_nonce,page:1,pageno:1,limit:e,wpml_lang:wisdm_ld_reports_common_script_data.wpml_lang},r=null!=wisdm_learndash_reports_front_end_script_quiz_reports.lastCustomDefaultQuiryParams?wisdm_learndash_reports_front_end_script_quiz_reports.lastCustomDefaultQuiryParams:[];jQuery.each(r,(function(e,r){if(null!=t[e])return!0;null!==r&&(t[e]=r)})),jQuery(".qre-reports-content, .custom-reports-content, .qre-reports-content").html(""),jQuery(".wrld-loader").show(),jQuery.get(wisdm_learndash_reports_front_end_script_quiz_reports.ajaxurl,t,(function(e){jQuery(".wisdm-learndash-reports-quiz-reports").html(e.data.html),l("#qre_summarized_data",e.data.entries),i(".pagination-form","select.limit",".pagination-section input.page",".pagination-section button.previous-page",".pagination-section button.next-page");const t=document.getElementsByClassName("wrld-loader");t.length>0&&(0,n.createRoot)(t[0]).render(o().createElement(a))}))}))},window.change_page_number=function(e,t,r,s){jQuery(t).on("change",(function(){const e=parseInt(jQuery(this).val()),r=parseInt(jQuery(this).attr("data-max"));if(isNaN(e))return!1;if(e>r)return!1;const o=jQuery("select.limit").find("option:selected").val(),s={action:"get_quiz_reports_data",nonce:wisdm_learndash_reports_front_end_script_quiz_reports.report_nonce,page:e,pageno:e,limit:o,wpml_lang:wisdm_ld_reports_common_script_data.wpml_lang},a=null!=wisdm_learndash_reports_front_end_script_quiz_reports.lastCustomDefaultQuiryParams?wisdm_learndash_reports_front_end_script_quiz_reports.lastCustomDefaultQuiryParams:[];jQuery.each(a,(function(e,t){if(null!=s[e])return!0;null!==t&&(s[e]=t)})),jQuery.get(wisdm_learndash_reports_front_end_script_quiz_reports.ajaxurl,s,(function(r){jQuery(".wisdm-learndash-reports-quiz-reports").html(r.data.html),l("#qre_summarized_data",r.data.entries),i(".pagination-form","select.limit",".pagination-section input.page",".pagination-section button.previous-page",".pagination-section button.next-page"),jQuery(t).val(e)}))})),jQuery(s).on("click",(function(){const e=parseInt(jQuery(t).val()),r=parseInt(jQuery(t).attr("data-max"));if(e===r)return jQuery(this).attr("disabled","disabled"),!1;const s=jQuery("select.limit").find("option:selected").val(),d={action:"get_quiz_reports_data",nonce:wisdm_learndash_reports_front_end_script_quiz_reports.report_nonce,page:e+1,pageno:e+1,limit:s,wpml_lang:wisdm_ld_reports_common_script_data.wpml_lang},u=null!=wisdm_learndash_reports_front_end_script_quiz_reports.lastCustomDefaultQuiryParams?wisdm_learndash_reports_front_end_script_quiz_reports.lastCustomDefaultQuiryParams:[];jQuery.each(u,(function(e,t){if(null!=d[e])return!0;null!==t&&(d[e]=t)})),jQuery(".qre-reports-content, .custom-reports-content, .qre-reports-content").html(""),jQuery(".wrld-loader").show(),jQuery.get(wisdm_learndash_reports_front_end_script_quiz_reports.ajaxurl,d,(function(r){jQuery(".wisdm-learndash-reports-quiz-reports").html(r.data.html),l("#qre_summarized_data",r.data.entries),i(".pagination-form","select.limit",".pagination-section input.page",".pagination-section button.previous-page",".pagination-section button.next-page"),jQuery(t).val(e+1);const s=document.getElementsByClassName("wrld-loader");s.length>0&&(0,n.createRoot)(s[0]).render(o().createElement(a))}))})),jQuery(r).on("click",(function(){let e=parseInt(jQuery(t).val());if(1===e)return jQuery(this).attr("disabled","disabled"),!1;if(e-=1,e<1)return!1;const r=jQuery("select.limit").find("option:selected").val(),s={action:"get_quiz_reports_data",nonce:wisdm_learndash_reports_front_end_script_quiz_reports.report_nonce,page:e,pageno:e,limit:r,wpml_lang:wisdm_ld_reports_common_script_data.wpml_lang},d=null!=wisdm_learndash_reports_front_end_script_quiz_reports.lastCustomDefaultQuiryParams?wisdm_learndash_reports_front_end_script_quiz_reports.lastCustomDefaultQuiryParams:[];jQuery.each(d,(function(e,t){if(null!=s[e])return!0;null!==t&&(s[e]=t)})),jQuery(".qre-reports-content, .custom-reports-content, .qre-reports-content").html(""),jQuery(".wrld-loader").show(),jQuery.get(wisdm_learndash_reports_front_end_script_quiz_reports.ajaxurl,s,(function(r){jQuery(".wisdm-learndash-reports-quiz-reports").html(r.data.html),l("#qre_summarized_data",r.data.entries),i(".pagination-form","select.limit",".pagination-section input.page",".pagination-section button.previous-page",".pagination-section button.next-page"),jQuery(t).val(e);const s=document.getElementsByClassName("wrld-loader");s.length>0&&(0,n.createRoot)(s[0]).render(o().createElement(a))}))}))},jQuery(".mb-40").each((function(e,t){0==jQuery(t).text().trim().length&&jQuery(t).css({"margin-bottom":"0px"})})),document.addEventListener("DOMContentLoaded",(function(e){"quiz-reports"==wisdm_learndash_reports_front_end_script_quiz_reports.report_type?(jQuery(".wisdm-learndash-reports-quiz-reports").parent().show(),jQuery(".ld-course-field").hide(),document.getElementById("wisdm-learndash-reports-quiz-report-view").scrollIntoView()):(jQuery(".wisdm-learndash-reports-quiz-reports").parent().hide(),jQuery(".ld-course-field").css("display","flex")),jQuery(".qre-reports-content .back-button").on("click",(function(e){e.preventDefault(),open(location,"_self").close()}))}))})();